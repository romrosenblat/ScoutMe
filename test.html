<!DOCTYPE html>
<html>
<head>
    <title>ScoutMe</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <link href="css/snippet.css" rel="stylesheet" />
    <script type='text/javascript' src='https://www.gstatic.com/charts/loader.js'></script>
    <script src="js/jquery.js"></script>
    <script src="js/ajaxCalls.js"></script>
    <script src="js/scoutCalls.js"></script>
    <script>

        $(document).ready(function () {
            CountAthletes();
        });
            
       function CountAthletes(){
           AthletesCount(AthletesCountSuccess, erorrCB);
           AllUseresCount(UsersCountSuccess, erorrCB);

        }

       function AthletesCount(AthletesCountSuccess, erorrCB) {


            $.ajax({ // ajax call starts
                url: 'WebService.asmx/GetAthleteCount',   // server side web service method
                type: 'POST',                              // can be also GET
                dataType: 'json',                          // expecting JSON datatype from the server
                contentType: 'application/json; charset = utf-8', // sent to the server
                success: AthletesCountSuccess,                // data.d id the Variable data contains the data we get from serverside
                error: erorrCB
            }) // end of ajax call
       }

       function AthletesCountSuccess(data) {
           var athleteArr = JSON.parse(data.d);
               soccerCount = athleteArr[0].count;
               basketBallCount = athleteArr[1].count;
               handBallCount = athleteArr[2].count;
       }

       function AllUseresCount(UsersCountSuccess, erorrCB) {


           $.ajax({ // ajax call starts
               url: 'WebService.asmx/UsersCount',   // server side web service method
               type: 'POST',                              // can be also GET
               dataType: 'json',                          // expecting JSON datatype from the server
               contentType: 'application/json; charset = utf-8', // sent to the server
               success: UsersCountSuccess,                // data.d id the Variable data contains the data we get from serverside
               error: erorrCB
           }) // end of ajax call
       }

       function UsersCountSuccess(data) {
           var athleteArr = JSON.parse(data.d);
           athletecount = athleteArr[0].count;
           agentcount = athleteArr[1].count;
           teamcount = athleteArr[2].count;
       }

       function erorrCB() {

       }
        google.charts.load("current", {
            packages: ["corechart", "geochart"]
        });
        google.charts.setOnLoadCallback(init);

        function init() {
            drawLine();
            drawChart();
            drawCountChart();
        }

        function drawChart() {
            var dataPie = google.visualization.arrayToDataTable([
              ['Sport', 'Athletes Registered'],
              ['Soccer', parseInt(soccerCount)],
              ['BasketBall', parseInt(basketBallCount)],
            ['HandBall', parseInt(handBallCount)]
            ]);

            var optionsPie = {
                title: 'Athletes Registered',
                pieHole: 0.4,
            };

            var chartPie = new google.visualization.PieChart(document.getElementById('donutchart'));
            chartPie.draw(dataPie, optionsPie);
        }

        function drawLine() {
            var data1 = google.visualization.arrayToDataTable([
            ['City', 'Population', 'Area'],
            ['Haifa', 2761477, 1285.31],
            ['Tel Aviv', 1324110, 181.76]
            ]);
            var options1 = {
                region: 'IL',
                displayMode: 'markers',
                colorAxis: { colors: ['green', 'blue'] }
            };
            var chart1 = new google.visualization.GeoChart(document.getElementById('chart_div'));
            chart1.draw(data1, options1);
        }
      function drawCountChart(){
          var data = google.visualization.arrayToDataTable([
          ['User Type', 'Count'],
          ['Athletes', parseInt(athletecount)],
          ['Agents', parseInt(agentcount)],
          ['Teams', parseInt(teamcount)]
          ]);

          var options = {
              title: 'Users Types'
          };

          var chart = new google.visualization.PieChart(document.getElementById('piechart'));

          chart.draw(data, options);
        }

    </script>
</head>
<body>
    <!--Google Fonts-->
    <link href='http://fonts.googleapis.com/css?family=Stalemate|Balthazar&subset=latin,latin-ext' rel='stylesheet'
          type='text/css'>
    <!--Font Awesome-->
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <table>
        <tr>
            <td><div id="donutchart" style="width: 700px; height: 300px;"></div>
            </td>
            <td>
                <div id="chart_div" style="width: 700px; height: 300px;"></div>
            </td>
            <td>
                <div id="piechart" style="width: 700px; height: 300px;"></div>
            </td>
        </tr>
    </table>


</body>
</html>